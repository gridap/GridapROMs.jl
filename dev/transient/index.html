<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Usage - Transient problem · GridapROMs.jl</title><meta name="title" content="Usage - Transient problem · GridapROMs.jl"/><meta property="og:title" content="Usage - Transient problem · GridapROMs.jl"/><meta property="twitter:title" content="Usage - Transient problem · GridapROMs.jl"/><meta name="description" content="Documentation for GridapROMs.jl."/><meta property="og:description" content="Documentation for GridapROMs.jl."/><meta property="twitter:description" content="Documentation for GridapROMs.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="GridapROMs.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">GridapROMs.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Usage</span><ul><li><a class="tocitem" href="../steady/">Usage - Steady problem</a></li><li class="is-active"><a class="tocitem" href>Usage - Transient problem</a><ul class="internal"><li><a class="tocitem" href="#FE-code"><span>FE code</span></a></li><li><a class="tocitem" href="#GridapROMs-code"><span>GridapROMs code</span></a></li></ul></li></ul></li><li><span class="tocitem">FEM Interface</span><ul><li><a class="tocitem" href="../utils/">GridapROMs.Utils</a></li><li><a class="tocitem" href="../dof_maps/">GridapROMs.DofMaps</a></li><li><a class="tocitem" href="../tproduct/">GridapROMs.TProduct</a></li><li><a class="tocitem" href="../param_data_structures/">GridapROMs.ParamDataStructures</a></li><li><a class="tocitem" href="../param_fe_spaces/">GridapROMs.ParamFESpaces</a></li><li><a class="tocitem" href="../param_steady/">GridapROMs.ParamSteady</a></li><li><a class="tocitem" href="../param_odes/">GridapROMs.ParamODEs</a></li></ul></li><li><span class="tocitem">ROM Interface</span><ul><li><a class="tocitem" href="../rbsteady/">GridapROMs.RBSteady</a></li><li><a class="tocitem" href="../rbtransient/">GridapROMs.RBTransient</a></li></ul></li><li><span class="tocitem">Distributed Interface</span><ul><li><a class="tocitem" href="../rbsteady/">GridapROMs.RBSteady</a></li><li><a class="tocitem" href="../rbtransient/">GridapROMs.RBTransient</a></li></ul></li><li><a class="tocitem" href="../contributing/">Contributing</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Usage</a></li><li class="is-active"><a href>Usage - Transient problem</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Usage - Transient problem</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/gridap/GridapROMs.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/gridap/GridapROMs.jl/blob/main/docs/src/transient.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Usage-Transient-problem"><a class="docs-heading-anchor" href="#Usage-Transient-problem">Usage - Transient problem</a><a id="Usage-Transient-problem-1"></a><a class="docs-heading-anchor-permalink" href="#Usage-Transient-problem" title="Permalink"></a></h1><p>In this example we solve a more complicated problem, namely a parameter- and time-dependent version of the Navier-Stokes equations.</p><h2 id="FE-code"><a class="docs-heading-anchor" href="#FE-code">FE code</a><a id="FE-code-1"></a><a class="docs-heading-anchor-permalink" href="#FE-code" title="Permalink"></a></h2><p>We start by loading the necessary packages  </p><pre><code class="language-julia hljs">using Gridap
using GridapSolvers
using GridapSolvers.LinearSolvers
using GridapSolvers.NonlinearSolvers
using DrWatson
using Serialization

using GridapROMs

import Gridap.MultiField: BlockMultiFieldStyle</code></pre><p>Next, we load a <code>DiscreteModel</code> from file (which can be found among the assets of the repo)</p><pre><code class="language-julia hljs">model_dir = datadir(joinpath(&quot;models&quot;,&quot;model_circle_2d.json&quot;))
Ωₕ = DiscreteModelFromFile(model_dir)
labels = get_face_labeling(Ωₕ)
add_tag_from_tags!(labels,&quot;dirichlet0&quot;,[&quot;walls_p&quot;,&quot;walls&quot;,&quot;cylinders_p&quot;,&quot;cylinders&quot;])
add_tag_from_tags!(labels,&quot;dirichlet&quot;,[&quot;inlet&quot;])</code></pre><p>Now, we introduce the space of tuples <code>(μ,t)</code> </p><pre><code class="language-julia hljs">dt = 0.0025
t0 = 0.0
tf = 60*dt

pdomain = fill([1.0,10.0],3)
tdomain = t0:dt:tf
Dt = TransientParamSpace(pdomain,tdomain)</code></pre><p>The main difference with respect to the steady case is that we consider as realizations sets of tuples <code>(μ,t)</code>. This allows for a much cleaner representation of the <code>(μ,t)</code>-dependence in the problem. </p><div class="admonition is-info" id="Note-d580e91f1d7518fc"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-d580e91f1d7518fc" title="Permalink"></a></header><div class="admonition-body"></div></div><p>Times are not sampled from a <a href="../param_data_structures/#GridapROMs.ParamDataStructures.TransientParamSpace"><code>TransientParamSpace</code></a>, in the sense that we consider the sets <code>(μ,t) ∀ t ∈ t0:dt:tf</code>, where <code>μ</code> is a sampled quantity.</p><p>The way in which we simultaneously evaluate parameter- and time-dependent functions is with the structure <code>TransientParamFunction</code>, which generalizes a <a href="../param_data_structures/#GridapROMs.ParamDataStructures.ParamFunction"><code>ParamFunction</code></a> to the transient case. For example, we can consider the following Dirichlet datum for our problem</p><pre><code class="language-julia hljs">const W = 0.5
inflow(μ,t) = abs(1-cos(2π*t/tf)+μ[3]*sin(μ[2]*2π*t/tf)/100)
g_in(μ,t) = x -&gt; VectorValue(-x[2]*(W-x[2])*inflow(μ,t),0.0)
gₚₜ_in(μ,t) = TransientParamFunction(g_in,μ,t)
g_0(μ,t) = x -&gt; VectorValue(0.0,0.0)
gₚₜ_0(μ,t) = TransientParamFunction(g_0,μ,t)</code></pre><p>which we use to define the FE spaces. We employ the Inf-Sup stable <code>P2-P1</code> (Taylor-Hood) pair for velocity and pressure, respectively:</p><pre><code class="language-julia hljs">order = 2
reffe_u = ReferenceFE(lagrangian,VectorValue{2,Float64},order)
V = TestFESpace(Ωₕ,reffe_u;conformity=:H1,dirichlet_tags=[&quot;dirichlet&quot;,&quot;dirichlet0&quot;])
U = TransientTrialParamFESpace(V,[gₚₜ_in,gₚₜ_0])
reffe_p = ReferenceFE(lagrangian,Float64,order-1)
Q = TestFESpace(Ωₕ,reffe_p;conformity=:H1)
P = TransientTrialParamFESpace(Q)
Y = TransientMultiFieldParamFESpace([V,Q];style=BlockMultiFieldStyle())
X = TransientMultiFieldParamFESpace([U,P];style=BlockMultiFieldStyle())</code></pre><p>A <a href="../param_odes/#GridapROMs.ParamODEs.TransientTrialParamFESpace"><code>TransientTrialParamFESpace</code></a> extends a traditional <code>TransientTrialFESpace</code> in Gridap, as it allows to provide a <code>(μ,t)</code>-dependent Dirichlet datum. The same holds for the multi-field version <a href="../param_odes/#GridapROMs.ParamODEs.TransientMultiFieldParamFESpace"><code>TransientMultiFieldParamFESpace</code></a>. </p><div class="admonition is-info" id="Note-d580e91f1d7518fc"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-d580e91f1d7518fc" title="Permalink"></a></header><div class="admonition-body"></div></div><p>In the multi-field scenario, the <code>BlockMultiFieldStyle</code> style should always be used. Check the appropriate documentation of <a href="https://github.com/gridap/Gridap.jl">Gridap</a> for more information.</p><p>Now we introduce the information related to the numerical integration </p><pre><code class="language-julia hljs">order = 2
degree = 2*order+1
τₕ = Triangulation(Ωₕ)
dΩₕ = Measure(τₕ,degree)</code></pre><p>and then the problem&#39;s weak formulation </p><pre><code class="language-julia hljs">const Re = 100.0
a(x,μ,t) = μ[1]/Re
a(μ,t) = x-&gt;a(x,μ,t)
aμt(μ,t) = TransientParamFunction(a,μ,t)

conv(u,∇u) = (∇u&#39;)⋅u
dconv(du,∇du,u,∇u) = conv(u,∇du)+conv(du,∇u)
c(u,v,dΩₕ) = ∫( v⊙(conv∘(u,∇(u))) )dΩₕ
dc(u,du,v,dΩₕ) = ∫( v⊙(dconv∘(du,∇(du),u,∇(u))) )dΩₕ

stiffness(μ,t,(u,p),(v,q),dΩₕ) = ∫(aμt(μ,t)*∇(v)⊙∇(u))dΩₕ - ∫(p*(∇⋅(v)))dΩₕ + ∫(q*(∇⋅(u)))dΩₕ
mass(μ,t,(uₜ,pₜ),(v,q),dΩₕ) = ∫(v⋅uₜ)dΩₕ
res(μ,t,(u,p),(v,q),dΩₕ) = ∫(v⋅∂t(u))dΩₕ + stiffness(μ,t,(u,p),(v,q),dΩₕ)

res_nlin(μ,t,(u,p),(v,q),dΩₕ) = c(u,v,dΩₕ)
jac_nlin(μ,t,(u,p),(du,dp),(v,q),dΩₕ) = dc(u,du,v,dΩₕ)</code></pre><p>Note that we have split the linear terms of the Navier-Stokes equations from the nonlinear convection terms, allowing us to increase efficiency of the algorithm. Now we introduce two FE operators, one for the linear terms and the other for the nonlinear ones:</p><pre><code class="language-julia hljs">τₕ_res = (τₕ,)
τₕ_jac = (τₕ,)
τₕ_jac_t = (τₕ,)
domains_lin = FEDomains(τₕ_res,(τₕ_jac,τₕ_jac_t))
domains_nlin = FEDomains(τₕ_res,(τₕ_jac,))

feop_lin = TransientLinearParamOperator((stiffness,mass),res,Dt,
  X,Y,domains_lin)
feop_nlin = TransientParamOperator(res_nlin,jac_nlin,Dt,
  X,Y,domains_nlin)

feop = LinearNonlinearTransientParamOperator(feop_lin,feop_nlin)</code></pre><p>Next, we define the time marching scheme for our problem, along with a suitable initial condition </p><pre><code class="language-julia hljs">u0(x,μ) = VectorValue(0.0,0.0)
u0(μ) = x-&gt;u0(x,μ)
u0μ(μ) = ParamFunction(u0,μ)
p0(x,μ) = 0.0
p0(μ) = x-&gt;p0(x,μ)
p0μ(μ) = ParamFunction(p0,μ)
xh0μ(μ) = interpolate_everywhere([u0μ(μ),p0μ(μ)],X(μ,t0))

nls = NewtonSolver(LUSolver();rtol=1e-10)
θ = 1
fesolver = ThetaMethod(nls,dt,θ)</code></pre><h2 id="GridapROMs-code"><a class="docs-heading-anchor" href="#GridapROMs-code">GridapROMs code</a><a id="GridapROMs-code-1"></a><a class="docs-heading-anchor-permalink" href="#GridapROMs-code" title="Permalink"></a></h2><p>We finally discuss the code relative to the reduced part. As usual we start by defining the <code>RBSolver</code> of the problem </p><pre><code class="language-julia hljs">coupling((du,dp),(v,q)) = ∫(dp*(∇⋅(v)))dΩₕ
energy((du,dp),(v,q)) = ∫(∇(v)⊙∇(du))dΩₕ + ∫(dp*q)dΩₕ

tol = 1e-4
state_reduction = HighDimReduction(coupling,tol,energy;nparams=50,sketch=:sprn)
rbsolver = RBSolver(fesolver,state_reduction;nparams_res=40,nparams_jac=40)
</code></pre><p>The main novelty is the use of transient reduction techniques. In particular:</p><ul><li><p>A <a href="@ref"><code>HighDimReduction</code></a> provides the information related to a reduction in space, and a reduction in time. </p></li><li><p>A <a href="@ref"><code>HighDimMDEIMHyperReduction</code></a> provides the information related to a hyper-reduction in space, and a hyper-reduction in time. This is automatically built within the <code>RBSolver</code>, simply by passing as keyword argument the number of parameters for residual and Jacobians.</p></li><li><p>Whenever we provide a <code>coupling</code> variable in the reduction strategy, a reduction of type <code>SupremizerReduction</code> is returned. This type simply acts as a wrapper for a reduction strategy (of type <code>HighDimReduction</code> in our case), and has the scope of performing a supremizer enrichment for the stabilization of the reduced problem. Check <a href="https://doi.org/10.1002/nme.4772">this</a> reference for more details on supremizer stabilizations. They are useful, for e.g., when reducting saddle-point problems such as the Stokes or Navier-Stokes equations.</p></li></ul><p>The subsequent steps procede as in a steady problem:</p><pre><code class="language-julia hljs">using DrWatson 
using Serialization

dir = datadir(&quot;navier-stokes&quot;)
create_dir(dir) 

try # try loading offline quantities
    rbop = load_operator(dir,feop)
catch # offline phase
    rbop = reduced_operator(rbsolver,feop,xh0μ)
    save(dir,rbop)
end

μₒₙ = realization(Dt;nparams=10,sampling=:uniform)
x̂on,rbstats = solve(rbsolver,rbop,μₒₙ,xh0μ)

xon,festats = solution_snapshots(rbsolver,feop,μₒₙ,xh0μ)
perf = eval_performance(rbsolver,feop,rbop,xon,x̂on,festats,rbstats)
println(perf)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../steady/">« Usage - Steady problem</a><a class="docs-footer-nextpage" href="../utils/">GridapROMs.Utils »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Friday 29 August 2025 02:17">Friday 29 August 2025</span>. Using Julia version 1.11.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
